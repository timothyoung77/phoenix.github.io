---
title: "大学规划经验公益讲座"
subtitle: "培风 & PHOENIX & 青蓝"
author: "Iris Yao"
date: "February 2021"
output:
  xaringan::moon_reader:
    css: ["default", "assets/sydney-fonts.css", "assets/sydney.css"]
    self_contained: false # if true, fonts will be stored locally
    seal: true # show a title slide with YAML information
    includes:
      in_header: "assets/mathjax-equation-numbers.html"
    nature:
      beforeInit: ["assets/remark-zoom.js", "https://platform.twitter.com/widgets.js"]
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9' # alternatives '16:9' or '4:3' or others e.g. 13:9
      navigation:
        scroll: false # disable slide transitions by scrolling
---

```{r, load_refs, echo=FALSE, cache=FALSE}
library(RefManageR)
BibOptions(check.entries = FALSE, 
           bib.style = "authoryear", 
           cite.style = 'authoryear', 
           style = "markdown",
           hyperlink = FALSE, 
           dashed = FALSE)
myBib <- ReadBib("assets/example.bib", check = FALSE)
```



```{r include=FALSE,echo = FALSE,message=FALSE}
library(dplyr)
library(ggplot2)
library(readr)
library(janitor)
library(tidyr)
library(pwr)
library(corrgram)
library(corrplot)
library(ggplot2)
library(GGally)
library(gridExtra)
library(caret)
winequality_red = read_csv("~/Desktop/Data2002_asm/winequality/winequality-red.csv")
w_r = janitor::clean_names(winequality_red)
winequality_white = read_csv("~/Desktop/Data2002_asm/winequality/winequality-white.csv")
w_t = janitor::clean_names(winequality_white)
w_r_dataframe = as.data.frame(w_r)
vector_w_r = colnames(w_r)

M0 = lm(quality ~ 1, data = w_r_dataframe) # Null model
M1 = lm(quality ~ ., data = w_r_dataframe) # Full model
round(summary(M1)$coef, 4)
M2 = update(M1, . ~ . - density)

M3 = update(M2, . ~ . - fixed_acidity)

M4 = update(M3, . ~ . - residual_sugar)

M5 = update(M4, . ~ . - citric_acid)

full_m = lm(quality ~ ., data = w_r_dataframe)
round(summary(full_m)$coef, 3)

```


```{r,fig.width=12, fig.height=7,echo=FALSE,echo = FALSE,message=FALSE}
w_t_dataframe = as.data.frame(w_t)
vector_w_t = colnames(w_t)

m0 = lm(quality ~ 1, data = w_t_dataframe) # Null model
m1 = lm(quality ~ ., data = w_t_dataframe) # Full model

m2 = update(m1, . ~ . - citric_acid)

m3 = update(m2, . ~ . - chlorides )

m4 = update(m3, . ~ . - total_sulfur_dioxide)

full_m_w = lm(quality ~ ., data = w_t_dataframe)
```


class: sydney-red

# .white[Content]

- 关于我们
- 合作机构介绍
- 校友展示
- PHOENIX的初衷
- 泛商科
- 工业界
- 学术界
- Q&A

---
background-image: url("phoenix.jpeg")
background-position: 100% 50%
background-size: 50% 75%

## About us `r icon::fa("columns", pull = "right")`

.pull-left[

- Phoenix 兴起于2020年8月悉尼大学学生会选举，是一个以中国大陆留学生及澳洲华裔学生主导的团体，是悉尼大学目前最大的国际学生团体之一。

- Phoenix 自创始以来，一直坚持着为留学生及其它弱势团体去一起争取权益，诉诸学生会及校内外团体去保 护权益的同时也希望身体力行去改善目前的学校环境，为大家做一些有意义的事情。

.small[
Subscribe us on Wechat [2020 MAKE CHANGE WITH PHOENIX](https://mp.weixin.qq.com/s/fAr1ITOhvrOz2XbyGxSutA)

More about SRC: [STUDENTS' REPRESENTATIVE COUNCIL, THE UNIVERSITY OF SYDNEY](http://srcusyd.net.au/)
]
]

---


background-image: url("青蓝.png")
background-position: 100% 50%
background-size: 50% 75%


## .brand-blue[青蓝 CheerLight] `r icon::fa("columns", pull = "right")`

.pull-left[
- 澳洲第一家专注于澳本申研/博的教育平台。100%澳本咨询老师背景，导师均来自哈佛/斯坦福/牛津/剑桥等顶级名校。更有雅思/托福满分/英美top校文学PhD提供文书/简历指导。以共赴申请季的名义，我们致力于将青蓝打造成为一个以澳本背景留学生为主的优质圈子和交流平台。

- 望同为澳本背景的学弟学妹们，内慎独修身，外精进优化，传承青蓝精神，超越青蓝前辈，到达更高境界。

.small[
为你撰写的故事 [师说 | 数学诗人“逃离”墨尔本计划](https://mp.weixin.qq.com/s/GYl05gceoxCwEUg0oFbGkg)

]
]

.footnote[

```
CheerLight
```

]
---


background-image: url("培风.jpeg")
background-size: 750px
background-position: 50% 75%


## .brand-yellow[培风]

- “培风”来自《庄子．逍遥游》，意为借助“大风”的力量飞向更高。
- 培风是一个分享澳本学生申请研究生和PhD（英美新港加欧澳地区）和求职规划的资讯共享平台，旨在努力打破澳本出国及求职的信息不对称。

.small[
 导师介绍 [泛商科，经济，理工篇导师一览，你准备好了吗？](https://mp.weixin.qq.com/s/KJepDZSbKSbyCiT54Tkyjg)
]

.footnote[

```
Usyd培风
```

]

---
class: segue-red

# Alumnus


.left[.footnote[



]]
---

## Lists, increments and footnotes`r icon::fa("list", pull = "right")`

.pull-left[

- Unordered lists<sup>1</sup>
  - can be created using "-"
  - and they can be nested using 2 or 4 space.fn[2]
      - deep nested 
  - original nesting level




]

--

.pull-right[
To get an incremental slide use two dashes `--` on a new line with no trailing white space. If the dashes aren't on their own line or there's a white space after it won't work.

.font80[.content-box-purple[
The two dash increments don't work inside class calls.  For example, you can't have an increment in a  `.pull-right[...]` block or in a `.columns-2[...]` block as the dashes are not considered to be special in the markdown processing when they're inside one of these blocks.
]]

]


---



background-image: url("assets/title-image1.jpg")
background-position: 100% 50%
background-size: 50% 75%

## PHOENIX的初衷

.pull-left[
`r icon::fa("rocket")` balabala



.font80[.content-box-purple[
- blablabla
]]

]



---

class: title-slide
background-image: url("assets/USydLogo-white.svg"), url("assets/title-image1.jpg")
background-position: 10% 90%, 100% 50%
background-size: 160px, 50% 100%
background-color: #0148A4


# .text-shadow[.white[泛商科方向]]

## .white[Business]

### .white[Author]

### .white[Date]

---
class: title-slide
background-image: url("assets/USydLogo-white.svg"), url("assets/IT.jpg")
background-position: 10% 90%, 100% 50%
background-size: 160px, 50% 100%
background-color: #0148A4


# .text-shadow[.white[理工科]]

## .white[STEM]

### .white[Author]

### .white[Date]



---


class: title-slide
background-image: url("assets/USydLogo-white.svg"), url("assets/law.png")
background-position: 10% 90%, 100% 50%
background-size: 160px, 50% 100%
background-color: #0148A4


# .text-shadow[.white[人文社科法律]]

## .white[Arts/Laws/Humanities]

### .white[Author]

### .white[Date]

---
## Assumptions `r icon::fa("columns", pull = "right")`

There are several assumptions that must be met for our regression model, which are:

- **Linearity** - the relationship between and is linear

- **Independence** - all the errors are independent of each other

- **Homoskedasticity** - the errors have constant variance for all

- **Normality** - the errors follow a normal distribution

---
## Linearity check(Red wine) `r icon::fa("r-project", pull = "right")`
### linear correlation between each biochemical index and quality

```{r,warning= FALSE, echo = FALSE, message=FALSE}
possible_attri_t = w_r_dataframe[c("quality","chlorides","alcohol","volatile_acidity","free_sulfur_dioxide","total_sulfur_dioxide","p_h","sulphates")]
lm_1 = lm(quality ~ alcohol, data = possible_attri_t)
lm_2 = lm(quality ~ volatile_acidity, data = possible_attri_t)
lm_3 = lm(quality ~ sulphates, data = possible_attri_t)
lm_4 = lm(quality ~ chlorides, data = possible_attri_t)
lm_5 = lm(quality ~ free_sulfur_dioxide, data = possible_attri_t)
lm_6 = lm(quality ~ total_sulfur_dioxide, data = possible_attri_t)
lm_7 = lm(quality ~ p_h, data = possible_attri_t)

possible_attri_t = possible_attri_t %>% mutate(resid_a = lm_1$residuals,resid_v =lm_2$residuals,resid_s =lm_3$residuals,resid_c = lm_4$residuals,resid_f = lm_5$residuals,resid_t = lm_6$residuals,resid_p = lm_7$residuals)


g2 = ggplot(possible_attri_t, aes(x = quality, y = volatile_acidity)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "volatile_acidity") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

g3 = ggplot(possible_attri_t, aes(x = quality, y = sulphates)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "sulphates") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

g4 = ggplot(possible_attri_t, aes(x = quality, y = chlorides)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "chloride") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

g5 = ggplot(possible_attri_t, aes(x = quality, y = free_sulfur_dioxide)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "free_sulfur_dioxide") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

g6 = ggplot(possible_attri_t, aes(x = quality, y = total_sulfur_dioxide)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "total_sulfur_dioxide") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

g7 = ggplot(possible_attri_t, aes(x = quality, y = p_h)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "p_h") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

```


.scroll-output[
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
g1 = ggplot(possible_attri_t, aes(x = quality, y = alcohol)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "Alcohol") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)
grid.arrange(g1, g2, g3,g4,g5,g6,g7,ncol=3)
```
]

---
## .brand-blue[Linearity check(White wine)] `r icon::fa("r-project", pull = "right")`
### linear correlation between each biochemical index and quality

```{r,warning= FALSE,echo=FALSE,message=FALSE}
possible_attri_t_w = w_t_dataframe[c("quality","residual_sugar","alcohol","volatile_acidity","free_sulfur_dioxide","density","p_h","sulphates","fixed_acidity")]
l_1 = lm(quality ~ alcohol, data = possible_attri_t_w)
l_2 = lm(quality ~ volatile_acidity, data = possible_attri_t_w)
l_3 = lm(quality ~ sulphates, data = possible_attri_t_w)
l_4 = lm(quality ~ residual_sugar, data = possible_attri_t_w)
l_5 = lm(quality ~ free_sulfur_dioxide, data = possible_attri_t_w)
l_6 = lm(quality ~ density , data = possible_attri_t_w)
l_7 = lm(quality ~ fixed_acidity, data = possible_attri_t_w)
l_8 = lm(quality ~ p_h, data = possible_attri_t_w)

possible_attri_t_w = possible_attri_t_w %>% mutate(resid_a = l_1$residuals,resid_v =l_2$residuals,resid_s =l_3$residuals,resid_r = l_4$residuals,resid_fr = l_5$residuals,resid_d = l_6$residuals,resid_f = l_7$residuals,resid_p = l_8$residuals)

p1 = ggplot(possible_attri_t_w, aes(x = quality, y = alcohol)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "Alcohol") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

p2 = ggplot(possible_attri_t_w, aes(x = quality, y = volatile_acidity)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "volatile_acidity") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

p3 = ggplot(possible_attri_t_w, aes(x = quality, y = sulphates)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "sulphates") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

p4 = ggplot(possible_attri_t_w, aes(x = quality, y = residual_sugar)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "residual_sugar") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

p5 = ggplot(possible_attri_t_w, aes(x = quality, y = free_sulfur_dioxide)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "free_sulfur_dioxide") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

p6 = ggplot(possible_attri_t_w, aes(x = quality, y = density)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "density") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

p7 = ggplot(possible_attri_t_w, aes(x = quality, y = p_h)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "p_h") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)



```
.small[.small[
.scroll-output[
```{r,fig.width=12, fig.height=7,warning= FALSE,echo=TRUE,message=FALSE}
p15 = ggplot(possible_attri_t_w, aes(x = quality, y = fixed_acidity)) +
geom_point() + theme_classic(base_size = 26) +
labs(x = "Quality", y = "fixed_acidity") + scale_y_log10()+geom_smooth(method = "lm", se = FALSE)

grid.arrange(p1, p2, p3,p4,p5,p6,p7,p15,ncol=3)
```
]
]]
---
## 我们的合作伙伴
<br>
.pull-left[.font80[.content-box-red[
- For all biochemical parameters in the wine, because at the time of data collection, they should be uniformly tested with professional instruments. The biochemical indicators should be independent of each other and should not affect each other.]]
<br>
]
.pull-right[.font80[.content-box-blue[
- The results of the chemical composition analysis of each wine are also independent of each other.]]
]
---
## Heterskedasticity check(Red wine) `r icon::fa("r-project", pull = "right")`
the overall distribution of residuals is spread-out, so that the heteroskedasticity assumption is largely satisfied

```{r,warning= FALSE, echo = FALSE, message=FALSE}
g9 = ggplot(possible_attri_t,
aes(x = volatile_acidity, y = resid_v)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "volatile_acidity",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

g10 = ggplot(possible_attri_t,
aes(x = sulphates, y = resid_s)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "sulphates",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

g11 = ggplot(possible_attri_t,
aes(x = alcohol, y = resid_c)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "chlorides",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

g12 = ggplot(possible_attri_t,
aes(x = alcohol, y = resid_f)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "free_sulfur_dioxide",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

g13 = ggplot(possible_attri_t,
aes(x = alcohol, y = resid_t)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "total_sulfur_dioxide",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

g14 = ggplot(possible_attri_t,
aes(x = alcohol, y = resid_p)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "p_h",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)
```

.scroll-output[
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
g8 = ggplot(possible_attri_t,
aes(x = alcohol, y = resid_a)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "Alcohol",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE) +theme(axis.text.x = element_text( size=20,face="plain"))
grid.arrange(g8, g9, g10,g11,g12,g13,g14,ncol=3)
```
]
---
## .brand-blue[Heterskedasticity check(White wine)]


```{r,warning= FALSE, echo = FALSE, message=FALSE}

p8 = ggplot(possible_attri_t_w,
aes(x = alcohol, y = resid_a)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "Alcohol",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE) +theme(axis.text.x = element_text( size=20,face="plain"))

p9 = ggplot(possible_attri_t_w,
aes(x = volatile_acidity, y = resid_v)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "volatile_acidity",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

p10 = ggplot(possible_attri_t_w,
aes(x = sulphates, y = resid_s)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "sulphates",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

p11 = ggplot(possible_attri_t_w,
aes(x = residual_sugar, y = resid_r)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "residual_sugar",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

p12 = ggplot(possible_attri_t_w,
aes(x = free_sulfur_dioxide, y = resid_fr)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "free_sulfur_dioxide",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

p13 = ggplot(possible_attri_t_w,
aes(x = density, y = resid_d)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "density",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

p14 = ggplot(possible_attri_t_w,
aes(x = p_h, y = resid_p)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "p_h",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)


```
.scroll-output[
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}

p16 = ggplot(possible_attri_t_w,
aes(x = fixed_acidity, y = resid_f)) +
geom_point(size = 1) + theme_classic(base_size = 30) + labs(x = "fixed_acidity",
y = "Residual") + geom_hline(yintercept = 0) + geom_smooth(method = "loess", se = FALSE)

grid.arrange(p8, p9, p10,p11,p12,p13,p14,p16,ncol=3)
```
]
---
## Normality check(Red wine) `r icon::fa("r-project", pull = "right")`
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
test = w_r %>% mutate(resid = M5$residuals,fitted = M5$fitted.values)
test %>% ggplot() + aes(sample = resid) + geom_qq(size = 2) + geom_qq_line()
```
The normality assumption for the residuals is reasonably well satisfied.

---
## .brand-blue[Normality check(White wine)] `r icon::fa("r-project", pull = "right")`
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
test = w_t %>% mutate(resid = m4$residuals,fitted = m4$fitted.values)
test %>% ggplot() + aes(sample = resid) + geom_qq(size = 2) + geom_qq_line()
```

---
## Variable selection(Red wine) `r icon::fa("question-circle", pull = "right")`
<blockquote>
What method did we applied?
</blockquote>

1. Backwards elimination
1. Forward selection
1. Custom elimination based on full model<br>

--

<blockquote>
How does each of these method works?<br>
</blockquote>

---
# Did the results showed any differences? `r icon::fa("question-circle", pull = "right")`

.pull-left[
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE}
step.back.aic = step(full_m,
                     direction = "backward"
                     ,
                     trace = FALSE)
null_m = lm(quality ~ 1, data = w_r_dataframe)
step.fwd.aic = step(null_m, scope = list(lower = null_m, upper = full_m), direction = "forward"
                    , trace = FALSE)

```
]
.pull-right[
.small[.small[.small[.small[.small[.small[
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = FALSE}
sjPlot::tab_model(
  step.fwd.aic, step.back.aic,M5,
  show.ci = FALSE,
  show.aic = TRUE,
  dv.labels = c("Forward model"
                ,
                "Backward model"
                ,
                "Custom model")
)
```
]]]]]]
]
---
## .brand-blue[Variable selection(White wine)]

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = FALSE}
step.back.aic = step(full_m_w,
                     direction = "backward"
                     ,
                     trace = FALSE)
null_m = lm(quality ~ 1, data = w_t_dataframe)
step.fwd.aic = step(null_m, scope = list(lower = null_m, upper = full_m), direction = "forward"
                    , trace = FALSE)
```

.pull-left[
Results for white wine:
.small[.small[.small[.small[
```{r,fig.width=12, fig.height=7,warning= FALSE, echo = FALSE}
sjPlot::tab_model(
  step.fwd.aic, step.back.aic,m4,
  show.ci = FALSE,
  show.aic = TRUE,
  dv.labels = c("Forward model"
                ,
                "Backward model"
                ,
                "Custom model")
)
```
]]]]
]

---
## Model results(Red wine) `r icon::fa("box", pull = "right")`

.pull-left[
There is very strong evidence in the data to indicate a linear relationship between quality and these seven variablies.
```{r}
summary(M5)$coefficients %>% round(4)
```

]
---

### Why we selected this model? (performance perspective)

.red[In sample:]<br>
r square comparing the multiple regression to the full model
```{r,fig.width=8, fig.height=6,warning= FALSE}
summary(M1)$r.squared
summary(M5)$r.squared
```




---
## Out of sample: `r icon::fa("r-project", pull = "right")`
### Using 10-fold cross validation to evaluate the model by MAE and RMSE

```{r,fig.width=8, fig.height=6,warning= FALSE, echo = FALSE}
set.seed(2)
fold_id = c(1,1,1,1,1,1,1,1,1, rep(1:10, each = 159))
w_r_dataframe$fold_id = sample(fold_id, replace = FALSE)
k = 10
simple_mse = full_mse = vector(mode = "numeric", length = k)
simple_mae = full_mae = vector(mode = "numeric", length = k)
for(i in 1:k) { 
  test_set = w_r_dataframe[fold_id == i,]
  training_set = w_r_dataframe[fold_id != i,]
  simple_lm = lm(quality ~ volatile_acidity + citric_acid + chlorides + free_sulfur_dioxide + total_sulfur_dioxide + p_h+sulphates+alcohol, data = training_set)
  simple_pred = predict(simple_lm, test_set)
  simple_mse[i] = mean((test_set$quality - simple_pred)^2)
  simple_mae[i] = mean(abs(test_set$quality - simple_pred))
  full_lm = lm(quality ~ ., data = training_set)
  full_pred = predict(full_lm, test_set)
  full_mse[i] = mean((test_set$quality - full_pred)^2)
  full_mae[i] = mean(abs(test_set$quality - full_pred))
}

```

.pull-left[
```{r,fig.width=8, fig.height=6,warning= FALSE, echo = TRUE}
cv_res = tibble(simple_mse, full_mse, 
                simple_mae, full_mae)
cv_res

```
]
.pull-right[
.red[Root mean square errors:]

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
c(sqrt(mean(simple_mse)),
  sqrt(mean(full_mse))) %>% round(4)
```

.red[Mean absolute errors:]

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
c(mean(simple_mae),
  mean(full_mae)) %>% round(4)
```
]
---

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
cv_res %>% gather(key = "metric", value = "error") %>% 
  separate(col = metric, into = c("model","metric")) %>% 
  ggplot(aes(x = model, y = error)) + facet_wrap(~metric, scales = "free_y") + 
  geom_boxplot()
```

---
.small[.small[
.pull-left[
```
Linear Regression 

1599 samples
  12 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1440, 1438, 1439, 1440, 1438, 1439, ... 
Resampling results:

  RMSE       Rsquared   MAE      
  0.6515518  0.3516046  0.5052953


```

]
.pull-right[
```
Linear Regression 

1599 samples
   8 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1440, 1439, 1439, 1438, 1439, 1439, ... 
Resampling results:

  RMSE       Rsquared   MAE      
  0.6493783  0.3585636  0.5042778


```
]
]]
<br><br><br>
.content-box-red[From above we can know that the new model have a good fit on the data compared with the full model.<br>
**Possible model**: Y(quality) = **4.4301** + **0.8827** sulphates - **1.0128** volatile_acidity + **0.2893** alcohol - **2.0178 **chlorides + **0.0051**free_sulfur_dioxide - **0.0035**total_sulfur_dioxide - **0.4827**p_h]<br>

---
## .brand-blue[Model results(White wine)] `r icon::fa("box", pull = "right")`

### Why we selected this model? (performance perspective)

.blue[In sample:]<br>
r square comparing the multiple regression to the full model
```{r,fig.width=8, fig.height=6,warning= FALSE}
summary(m1)$r.squared
summary(m4)$r.squared
```




---
## Out of sample: `r icon::fa("r-project", pull = "right")`
###Using 10-fold cross validation to evaluate the model by MAE and RMSE

```{r,warning= FALSE, echo = FALSE}
set.seed(2)
fold_id = c(1,1,1,1,1,1,1,1, rep(1:10, each = 489))
w_t_dataframe$fold_id = sample(fold_id, replace = FALSE)
k = 10
simple_mse = full_mse = vector(mode = "numeric", length = k)
simple_mae = full_mae = vector(mode = "numeric", length = k)
for(i in 1:k) { 
  test_set = w_t_dataframe[fold_id == i,]
  training_set = w_t_dataframe[fold_id != i,]
  simple_lm = lm(quality ~ volatile_acidity + density+ residual_sugar + free_sulfur_dioxide + fixed_acidity  + p_h+sulphates+alcohol, data = training_set)
  simple_pred = predict(simple_lm, test_set)
  simple_mse[i] = mean((test_set$quality - simple_pred)^2)
  simple_mae[i] = mean(abs(test_set$quality - simple_pred))
  full_lm = lm(quality ~ ., data = training_set)
  full_pred = predict(full_lm, test_set)
  full_mse[i] = mean((test_set$quality - full_pred)^2)
  full_mae[i] = mean(abs(test_set$quality - full_pred))
}
```

.pull-left[
```{r,fig.width=8, fig.height=6,warning= FALSE, echo = TRUE}
cv_res = tibble(simple_mse, full_mse, 
                simple_mae, full_mae)
cv_res

```
]
.pull-right[
.red[Root mean square errors:]

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
c(sqrt(mean(simple_mse)),
  sqrt(mean(full_mse))) %>% round(4)
```

.red[Mean absolute errors:]

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
c(mean(simple_mae),
  mean(full_mae)) %>% round(4)
```
]
---

```{r,fig.width=12, fig.height=7,warning= FALSE, echo = TRUE, message=FALSE}
cv_res %>% gather(key = "metric", value = "error") %>% 
  separate(col = metric, into = c("model","metric")) %>% 
  ggplot(aes(x = model, y = error)) + facet_wrap(~metric, scales = "free_y") + 
  geom_boxplot()
```

---
.small[.small[
.pull-left[
```
Linear Regression 

4898 samples
  12 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 4408, 4408, 4408, 4408, 4408, 4408, ... 
Resampling results:

  RMSE       Rsquared   MAE      
  0.7534778  0.2780082  0.5854609

```
]
.pull-right[
```
Linear Regression 

4898 samples
   8 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 4409, 4408, 4408, 4408, 4408, 4409, ... 
Resampling results:

  RMSE       Rsquared   MAE      
  0.7539453  0.2769609  0.5855296

```
]
]]
<br><br><br>
.content-box-blue[From above we can know that the new model have a good fit on the data compared with the full model.<br>
**Possible model**: Y(quality) = **154.1062** + **0.6285** sulphates - **1.8881** volatile_acidity + **0.1932** alcohol + **0.0828 **residual_sugar + **0.0033**free_sulfur_dioxide - **154.2913**density - **0.6942**p_h + **0.0681**fixed_acidity]

---

## Limitations `r icon::fa("quote-right", pull = "right")`


- Could outliers be dealt with better in anyways?
- Would any pre-processing help in comparison to what's done now?

---

## Wrap up

Briefly conclude what you have done




---
class: sydney-blue
background-image: url(assets/USydLogo-white.svg)
background-size: 260px
background-position: 5% 95%

# Thanks!


.pull-right[.pull-down[

<a href="https://archive.ics.uci.edu/ml/datasets/wine+quality">
.white[`r icon::fa("paper-plane")` UCI - Machine Learning Repository]
</a>

<a href="http://www3.dsi.uminho.pt/pcortez">
.white[`r icon::fa("link")` Paulo Cortez, University of Minho, Guimarães, Portugal]
</a>



<br><br><br>

]]
